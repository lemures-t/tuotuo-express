(function(){"use strict";function ib(d){for(var h=[],l=0,m=d.length;l<m;l++)h.push(jb+d[l]+".js");if(kb){d=[];for(l=Math.ceil(h.length/Ra);l--;)d.push(lb+h.splice(0,Ra).join(","));return d}l=0;for(m=h.length;l<m;l++)h[l]=wa+h[l];return h}function mb(d,h){if(d)return function(){--d||h()};h()}function xa(d){if(!ya[d]){ya[d]=!0;for(var h=J[d],l=h.length;l--;)xa(h[l]);za.push(d);Aa||(Aa=setTimeout(nb,0))}}function ob(d){var h=document.createElement("script");h.setAttribute("type","text/javascript");h.setAttribute("src",d);h.setAttribute("charset","utf-8");document.getElementsByTagName("head")[0].appendChild(h)}function nb(){Aa=0;var d=za;za=[];d.sort(function(d,h){return d<=h});for(var d=ib(d),h=d.length;h--;)ob(d[h])}function Ba(){"complete"==O.readyState&&(O.detachEvent("onreadystatechange",Ba),w.fireReady())}function Sa(){O.removeEventListener("DOMContentLoaded",Sa,!1);w.fireReady()}function pb(d,h){var l=document.getElementsByTagName("head")[0],m='<script src="'+d+'" '+ga+'="this.ownerDocument.z = 1"></script>',L=ma.createElement("iframe");L.style.display="none";l.appendChild(L);var A=L.contentDocument;L.onload=function(){1!=A.z&&h&&h();L.onload=null;l.removeChild(this)};try{A.write(m),A.close()}catch(n){}l=null}function qb(d,h,l,m,L){var A=ma.createElement("script");na.push({name:d,sender:A});A.setAttribute("type","text/javascript");A.setAttribute("charset",L||"gbk");A.async=!0;var n=null,w=!1;A[ga]=function(){rb.test(this.readyState)&&(ha(d),n?l&&l(n):w||m&&m())};Ca[d]=function(d){n=d};A.onerror=function(){w=!0;m&&m();ha(d)};L=["output=jsonp","fr=mapapi","cb="+Da+"."+d];L=h+(-1===h.indexOf("?")?"?":"&")+L.join("&");A.src=L;sb&&pb(h,function(){A.onerror()});h=document.getElementsByTagName("head")[0];h.insertBefore(A,h.firstChild);h=null}function ha(d){if(d){for(var h=0,l=na.length,m=null;h<l;h++)if(na[h].name===d){m=na.splice(h,1)[0];break}m&&(h=m.sender,h.clearAttributes&&h.clearAttributes(),h[ga]=h.onerror=null,h.parentNode&&h.parentNode.removeChild(h));Ca[d]&&delete Ca[d]}}var jb="/mods/",wa="http://s.map.qq.com/TPano/v1.1.1",kb=!1,J={TPano:[],h5:["TPano"],flash:["TPano"]},lb=wa+"c/=/",Ra=5,Ta={},R={},Ea={},H;for(H in J)if(J.hasOwnProperty(H)){var n=J[H];n[0]&&(Ta[n[0]]=!0);Ea[H]=[];R[H]=R[H]||[];for(var Fa=n.length;Fa--;){var Ga=n[Fa];R[Ga]?R[Ga].push(H):R[Ga]=[H]}}var S={},oa={},Ua,Ha={};window.__mjsload=function(d,h){if(!S.hasOwnProperty(d)){var l=J[d],m=R[d],L=mb(l.length,function(){var l=h;Ua=d;Ta[d]&&(l+=";(0,function(){return eval(arguments[0])})");l=oa[J[d][0]](l);oa[d]||(oa[d]=l);S.hasOwnProperty(d)||(S[d]=void 0);for(var l=Ea[d],n=0,L=l.length;n<L;n++)l[n](S[d]);for(l=m.length;l--;)if(n=m[l],Ha[n])Ha[n]()});Ha[d]=L;for(var n=l.length;n--;)S.hasOwnProperty(l[n])&&L()}};var ya={},za=[],Aa,Ia={$require:function(d,h,l){S.hasOwnProperty(d)?(d=S[d],h(void 0===l?d:d[l])):(xa(d),Ea[d].push(void 0===l?h:function(d){h(d[l])}))},$initMain:function(d,h){oa[d]=h;ya[d]=!0;S[d]=void 0},$setExports:function(d){S[Ua]=d}};Ia.$initMain("TPano",function(){return eval(arguments[0])});var Va={getItem:function(d){if((d=document.cookie.match(RegExp("\\b"+d+"=([^;]*)")))&&1<d.length)return decodeURIComponent(d[1])},set:function(d,h){document.cookie=d+"="+encodeURIComponent(h)}},Ja="",pa=navigator.userAgent,ia=/msie (\d+\.\d+)/i.test(pa)?document.documentMode||+RegExp.$1:0,w=[],O=document;w.isReady=!1;w._used=!1;w.ready=function(d){w.initReady();w.isReady?d():w.push(d)};w.initReady=function(){if(!w._used){w._used=!0;if("complete"===O.readyState||"interactive"===O.readyState)return w.fireReady();if(0<ia&&9>ia){O.attachEvent("onreadystatechange",Ba);var d=function(){if(!w.isReady){var h=new Image;try{h.doScroll()}catch(l){setTimeout(d,64);return}w.fireReady()}};d()}else O.addEventListener("DOMContentLoaded",Sa,!1)}};w.fireReady=function(){if(!w.isReady){if(!O.body)return setTimeout(w.fireReady,16);w.isReady=!0;if(w.length)for(var d=0,h;h=w[d];d++)h()}};var tb=w.ready,Wa=/opera(\/| )(\d+(\.\d+)?)(.+?(version\/(\d+(\.\d+)?)))?/i.test(pa)?+(RegExp.$6||RegExp.$2):0;new Function;var ma=window.document,rb=/loaded|complete|undefined/i,ga=ma.dispatchEvent?"onload":"onreadystatechange",sb=0<Wa,Da="QQPanoLoader",Ca=window[Da]={},na=[],ub=0,qa=function(d,h,l){for(var m in h)!h.hasOwnProperty(m)||!l&&d.hasOwnProperty(m)||(d[m]=h[m]);return d},ra={addListener:function(d,h,l){var m=this._dora_events=this._dora_events||{};m[h]=m[h]||[];m[h].push({action:l,context:d||this});return this},hasEventListeners:function(d){return"_dora_events"in this&&d in this._dora_events&&0<this._dora_events[d].length},removeEventListener:function(d,h,l){if(!this.hasEventListeners(h))return this;for(var m=0,n=this._dora_events,A=n[h].length;m<A;m++)if(n[h][m].action===l&&(!d||n[h][m].context===d)){n[h].splice(m,1);break}return this},fireEvent:function(d,h,l){if(!this.hasEventListeners(d))return this;d=this._dora_events[d].slice();for(var m=0,n=d.length;m<n;m++)l&&d[m].context!=l||d[m].action.call(d[m].context||this,h);return this},addScrollEvent:function(d,h,l){d.addEventListener&&d.addEventListener(h,l,!1);d.onmousewheel=l}},Ka=function(d,h){return function(l){new l(d,h)}},vb={send:function(d,h,l,m){d||(d="cb"+(new Date).getTime().toString(36)+(ub++).toString(36));tb(function(){ha(d);qb(d,h,l,m)});return d},cancel:ha};H={init:function(d){Ja=d},report:function(d,h){var l;(l=Va.getItem("suid"))||(l=(new Date).getUTCMilliseconds(),l=Math.round(2147483647*Math.random())*l%1e10,Va.set("suid",l));var m=l;l=new Image(1,1);m={appid:Ja,suid:m,logid:d,rand:Math.random()};if(h)for(var n in h)m[n]=h[n];var A;n=m;m=[];for(A in n)m.push(A+"="+encodeURIComponent(n[A]));A=m.join("&");l.src="http://pr.map.qq.com/pingd?"+A},downTPanoAPI:function(){this.report("tpanoapi_mainjs_download")}};H.init("TPanoAPI");H.downTPanoAPI();var wb={pano:null,zoom:1,scrollwheel:!0,disableLogo:!1,disableCompass:!1,disableFullScreen:!1,disableMove:!1,container:null,visible:!0,key:"",renderer:null,pf:"",from:"",ch:""},xb={id:function(){var d=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return d()+d()+d()+d()+d()+d()+d()+d()}(),content:"",position:{lat:0,lng:0},altitude:5,visible:!0};H=function(d){d=qa(d,wb);this._waitQuene=[];/\bmobile\b/i.test(navigator.userAgent)?Ia.$require("h5",Ka(this,d)):Ia.$require("flash",Ka(this,d));ra.addListener(this,"loaded",function(){if(!this._render)throw Error("Fatal Error! Render loaded but render not set correctly.");for(var d=this.getPano(),l=0,m=this._waitQuene.length;l<m;l++){var n=this._waitQuene[l];n.func.apply(n.scope,n.args)}d&&(this._waitQuene=null)})};n=H.prototype;n.setPov=function(d,h){var l={},m=!1;null==d||isNaN(Number(d))||(l.heading=Number(d),m=!0);null==h||isNaN(Number(h))||(l.pitch=Number(h),m=!0);m&&(this._render?this._render.setPov(l):this._waitQuene.push({args:arguments,scope:this,func:this.setPov}))};n.setPano=function(d){this._render?this._render.setPano(d):this._waitQuene.push({args:arguments,scope:this,func:this.setPano})};n.setZoom=function(d){this._render?this._render.setZoom(d):this._waitQuene.push({args:arguments,scope:this,func:this.setZoom})};n.setThumb=function(d){!d instanceof Object||(this._render?this._render.setThumb(d):this._waitQuene.push({args:arguments,scope:this,func:this.setThumb}))};n.updateViewport=function(){this._render?this._render.updateViewport&&this._render.updateViewport():this._waitQuene.push({args:arguments,scope:this,func:this.updateViewport})};n._removePano=function(){this._render?this._render.removePano():this._waitQuene.push({args:arguments,scope:this,func:this.removePano})};n.getPov=function(){if(this._render)return this._render._getKey("pov")};n.getPano=function(){if(this._render)return this._render._getKey("pano")};n.getZoom=function(){if(this._render)return this._render._getKey("zoom")};n.getPosition=function(){if(this._render)return this._render._getKey("position")};n.setVisible=function(d){this._render?this._render.setVisible(d):this._waitQuene.push({args:arguments,scope:this,func:this.setVisible})};n.fireEvent=function(d,h,l){ra.fireEvent(d,h,l||this)};n.getPanoContainer=function(){if(this._render)return this._render._getKey("panoContainer")};n.addLabel=function(d){var h=qa(d,xb);this._render?this._render.addLabel(h):this._waitQuene.push({args:arguments,scope:this,func:this.addLabel})};n.removeLabel=function(d){this._render?this._render.removeLabel(d):this._waitQuene.push({args:arguments,scope:this,func:this.removeLabel})};n._addPlugin=function(d){this._render?this._render.addPlugin(d):this._waitQuene.push({args:arguments,scope:this,func:this._addPlugin})};n.autoPlayStart=function(d){this._render?this._render.autoPlayStart(d):this._waitQuene.push({args:arguments,scope:this,func:this.autoPlayStart})};n.autoPlayStop=function(){this._render?this._render.autoPlayStop():this._waitQuene.push({args:arguments,scope:this,func:this.autoPlayStop})};n._setFailKey=function(d){this._render?this._render.setKeyStatus({status:0}):this._waitQuene.push({args:arguments,scope:this,func:this._setFailKey})};n._vertifyKey=function(d){if(!d)this._setFailKey();else if(location.host){var h=this;vb.send(null,"http://apikey.map.qq.com/mkey/index.php/mkey/check?key="+d,function(d){d&&d.info&&0===d.info.error||d&&d.info&&h._setFailKey()})}};n=window.qq||(window.qq={});n.pano=n.pano||{};n.pano.Panorama=H;n.pano.event=ra;})();
